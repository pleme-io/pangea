# Multi-Tier Architecture Infrastructure
# Configuration for a three-tier web application with separate templates
# for networking, application, and database layers

default_namespace: development

namespaces:
  # Local development environment
  development:
    description: "Local development with isolated state per template"
    state:
      type: local
      path: ".terraform/development/terraform.tfstate"
  
  # Testing environment with shared S3 backend
  testing:
    description: "Testing environment for integration tests"
    state:
      type: s3
      bucket: "company-terraform-state-testing"
      key: "multi-tier-app/testing/terraform.tfstate"
      region: "us-east-1"
      dynamodb_table: "terraform-state-lock-testing"
      encrypt: true
  
  # Staging environment - production-like
  staging:
    description: "Staging environment with production-grade state management"
    state:
      type: s3
      bucket: "company-terraform-state-staging"
      key: "multi-tier-app/staging/terraform.tfstate"
      region: "us-east-1"
      dynamodb_table: "terraform-state-lock-staging"
      encrypt: true
      iam_role: "arn:aws:iam::123456789012:role/TerraformStateRole"
  
  # Production environment with enhanced security
  production:
    description: "Production environment with KMS encryption and cross-account access"
    state:
      type: s3
      bucket: "company-terraform-state-prod"
      key: "multi-tier-app/production/terraform.tfstate"
      region: "us-east-1"
      dynamodb_table: "terraform-state-lock-prod"
      encrypt: true
      kms_key_id: "arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012"
      iam_role: "arn:aws:iam::987654321098:role/CrossAccountTerraformRole"