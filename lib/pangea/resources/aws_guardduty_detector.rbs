# RBS type definitions for AWS GuardDuty Detector resource

module Pangea
  module Resources
    module AWS
      module Types
        type guardduty_finding_frequency = "FIFTEEN_MINUTES" | "ONE_HOUR" | "SIX_HOURS"

        class GuardDutyDetectorAttributes < Dry::Struct
          def self.new: (Hash[Symbol, untyped] attributes) -> instance

          def enable: () -> bool
          def finding_publishing_frequency: () -> guardduty_finding_frequency
          def datasources: () -> Hash[Symbol, untyped]
          def tags: () -> Hash[Symbol, String]

          def has_s3_protection?: () -> bool
          def has_kubernetes_protection?: () -> bool
          def has_malware_protection?: () -> bool
          def enabled_datasources: () -> Array[String]
          def comprehensive_protection?: () -> bool
        end
      end

      # Create an AWS GuardDuty Detector
      def aws_guardduty_detector: (
        Symbol name,
        ?enable: bool,
        ?finding_publishing_frequency: Types::guardduty_finding_frequency,
        ?datasources: Hash[Symbol, untyped],
        ?tags: Hash[Symbol, String]
      ) -> ResourceReference
    end
  end
end