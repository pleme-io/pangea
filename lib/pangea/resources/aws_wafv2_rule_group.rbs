# RBS type definitions for AWS WAF v2 Rule Group resource

module Pangea
  module Resources
    module AWS
      module Types
        class WafV2RuleGroupAttributes < Dry::Struct
          def self.new: (Hash[Symbol, untyped] attributes) -> instance

          def name: () -> String
          def scope: () -> String
          def capacity: () -> Integer
          def description?: () -> String?
          def rules: () -> Array[Hash[Symbol, untyped]]
          def visibility_config: () -> Hash[Symbol, untyped]
          def tags: () -> Hash[Symbol, String]
          def custom_response_bodies: () -> Hash[String, Hash[Symbol, untyped]]

          def total_rule_count: () -> Integer
          def has_rate_limiting?: () -> bool
          def has_geo_blocking?: () -> bool
          def has_string_matching?: () -> bool
          def has_size_constraints?: () -> bool
          def uses_custom_responses?: () -> bool
          def rule_priorities: () -> Array[Integer]
          def cloudfront_compatible?: () -> bool
        end
      end

      # Create an AWS WAF v2 Rule Group
      def aws_wafv2_rule_group: (
        Symbol name,
        ?name: String,
        ?scope: Types::wafv2_scope,
        ?capacity: Integer,
        ?description: String,
        ?rules: Array[Hash[Symbol, untyped]],
        ?visibility_config: Hash[Symbol, untyped],
        ?tags: Hash[Symbol, String],
        ?custom_response_bodies: Hash[String, Hash[Symbol, untyped]]
      ) -> ResourceReference
    end
  end
end