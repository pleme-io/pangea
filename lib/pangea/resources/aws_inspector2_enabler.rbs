# RBS type definitions for AWS Inspector v2 Enabler resource

module Pangea
  module Resources
    module AWS
      module Types
        type inspector2_resource_type = "ECR" | "EC2"

        class Inspector2EnablerAttributes < Dry::Struct
          def self.new: (Hash[Symbol, untyped] attributes) -> instance

          def account_ids: () -> Array[String]
          def resource_types: () -> Array[inspector2_resource_type]

          def account_count: () -> Integer
          def resource_type_count: () -> Integer
          def covers_ec2?: () -> bool
          def covers_ecr?: () -> bool
          def comprehensive_coverage?: () -> bool
          def single_account?: () -> bool
          def multi_account?: () -> bool
        end
      end

      # Create an AWS Inspector v2 Enabler
      def aws_inspector2_enabler: (
        Symbol name,
        ?account_ids: Array[String],
        ?resource_types: Array[Types::inspector2_resource_type]
      ) -> ResourceReference
    end
  end
end