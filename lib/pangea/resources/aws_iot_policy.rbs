module Pangea
  module Resources
    module AWS
      class IotPolicyAttributes < Dry::Struct
        attr_reader name: String
        attr_reader policy: String
        attr_reader tags: Hash[Symbol, String]

        def parsed_policy: () -> Hash[String, untyped]
        def security_analysis: () -> Hash[Symbol, untyped]
        def iot_actions_analysis: () -> Hash[Symbol, Array[String]]
        def policy_recommendations: () -> Array[String]
      end

      def aws_iot_policy: (Symbol name, Hash[Symbol, untyped] attributes) -> ResourceReference
    end
  end
end